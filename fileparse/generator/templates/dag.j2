"""{{ description }}. += grepcka"""

import yaml
from datetime import timedelta
from pathlib import Path

from airflow import DAG
from airflow.exceptions import AirflowFailException
from airflow.models import Variable
from airflow.operators.bash import BashOperator
from airflow.operators.email import EmailOperator
from airflow.operators.python import PythonOperator, PythonVirtualenvOperator
from airflow.providers.snowflake.operators.snowflake import SnowflakeOperator
from airflow.utils.helpers import chain
from airflow.utils.trigger_rule import TriggerRule
from airflow.utils.dates import days_ago

CONFIG_FILE = "gener.yaml"
path = Path(__file__).with_name(CONFIG_FILE)

with path.open() as fp:
    config = yaml.load(fp, Loader=yaml.Loader)


{{ functions }}
DAG_DEFAULT_ARGS = {
    "owner": "airflow",
    "depends_on_past": False,
    "start_date": days_ago(1),
    "email": ["{{ support_email }}"],
    "email_on_failure": True,
    "email_on_retry": False,
    "retries": 1,
    "retry_delay": timedelta(minutes=5)
}


dag=DAG(
    dag_id=config["DAG_SETTINGS"]["dag_id"],
    description="This DAG was automatically generated by gener",
    default_args=DAG_DEFAULT_ARGS,
    catchup=False,
    schedule_interval=config["DAG_SETTINGS"]["dag_schedule"],
)

{{ ordering }}

{{ sequence }}

